(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["order"],{"56f2":function(t,e,r){"use strict";r.d(e,"a",function(){return a});var a={orderid:"订单号",createdtime:"创建时间",rent:"租金",deposit:"押金",wifi:"Wi-Fi",trash:"垃圾处理费",water:"水费",electricity:"电费",total:"总计",lastwatercnt:"上期水表",lastelectricitycnt:"上期电表",watercnt:"本期水表",electricitycnt:"本期电表",fromdate:"开始时间",todate:"结束时间",transaction_id:"微信订单号"}},cf2a:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"Order"},[t.isShowOneOrder?r("div",[r("div",{staticClass:"weui-cells__title"},[t._v("订单详情")]),r("div",{staticClass:"weui-cells"},[t._l(t.showProps,function(e,a){return r("div",{key:a,staticClass:"weui-cell"},[r("div",{staticClass:"weui-cell__bd"},[r("p",[t._v(t._s(t.GetPropName(e)))])]),r("div",{staticClass:"weui-cell__ft"},[t._v(t._s(t.GetPropValue(e)))])])}),r("a",{staticClass:"weui-cell weui-cell_link",on:{click:t.onSwitchRecord}},[r("div",{staticClass:"weui-cell__bd"},[t._v(t._s(t.isShowRec?"收起抄表记录":"展开抄表记录"))])]),t.isShowRec?r("div",t._l(t.recordProps,function(e,a){return r("div",{key:a,staticClass:"weui-cell"},[r("div",{staticClass:"weui-cell__bd"},[r("p",[t._v(t._s(t.GetPropName(e)))])]),r("div",{staticClass:"weui-cell__ft"},[t._v(t._s(t.GetPropValue(e)))])])}),0):t._e(),t.orderData.transaction_id?t._e():r("div",{staticClass:"weui-btn-area"},[r("a",{staticClass:"weui-btn weui-btn_primary",on:{click:function(e){t.onPay()}}},[t._v("支付")])])],2)]):r("div",[r("div",{staticClass:"weui-cells__title"},[t._v("历史订单")]),r("div",{staticClass:"weui-cells"},t._l(t.sortedOrder,function(e,a){return r("div",{key:a,staticClass:"weui-cell"},[r("div",{staticClass:"weui-cell__bd"},[r("p",[t._v(t._s(e.room+e.fromdate))])]),r("div",{staticClass:"weui-cell__ft"},[t._v(t._s("¥"+e.total))])])}),0)])])},i=[],o=r("9ab4"),n=r("60a3"),s=r("3a3d"),c=r("56f2"),d=r("a29c"),l=r("57c4"),u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.loginUser={},e.registerData={},e.orderData={},e.allOrderData={},e.isShowOneOrder=!1,e.isShowRec=!1,e}return o["c"](e,t),e.prototype.mounted=function(){this.loginUser=s["a"](),this.$route.query.orderid?(this.isShowOneOrder=!0,this.RequestOrderData(this.$route.query.orderid)):(this.isShowOneOrder=!1,this.RequestRegisterInfo(this.loginUser.openid))},e.prototype.RequestOrderData=function(t){var e=this;if(t){var r=d["a"],a=r+"/sunnyhouse/order?orderid="+t;n["b"].axios.get(a).then(function(t){var r=t.data;console.log("orderData",r),r&&"SUCCESS"===r.code&&(e.orderData=r.data)})}},e.prototype.RequestRegisterInfo=function(t){var e=this,r=d["a"],a=r+"/sunnyhouse/register?openid="+t;n["b"].axios.get(a).then(function(t){var r=t.data;console.log("RegisterInfo",r),r&&"SUCCESS"===r.code&&(e.registerData=r.data,e.RequestContractData())})},e.prototype.RequestContractData=function(){var t=this,e=this.registerData.contractid;if(e&&e.length>0){var r=d["a"],a=r+"/sunnyhouse/contract?mutli=1&contractid="+encodeURI(e.join(","));n["b"].axios.get(a).then(function(e){var r=e.data;if(console.log("ContractData",r),r&&"SUCCESS"===r.code){var a=r.data;if(a){var i=[];a.forEach(function(t){t.orderid&&t.orderid.forEach(function(t){i.push(t)})}),t.RequestMultiOrderData(i)}}})}},e.prototype.RequestMultiOrderData=function(t){var e=this,r=d["a"];if(t&&t.length>0){var a=r+"/sunnyhouse/order?mutli=1&orderid="+encodeURI(t.join(","));n["b"].axios.get(a).then(function(t){var r=t.data;if(console.log("OrderData",r),r&&"SUCCESS"===r.code){var a=r.data;a&&a.forEach(function(t){e.allOrderData[t.orderid]=t})}})}},e.prototype.GetPropName=function(t){return c["a"][t]},e.prototype.GetPropValue=function(t){var e=this.orderData;return"water"===t?"( "+e.watercnt+" - "+e.lastwatercnt+" ) * 2.5 = "+e.water:"electricity"===t?"( "+e.electricitycnt+" - "+e.lastelectricitycnt+" ) * 1.5 = "+e.electricity:"createdtime"===t?new Date(this.orderData[t]).toLocaleString():this.orderData[t]},e.prototype.onPay=function(){var t=this;if(this.orderData.orderid){var e=d["a"],r=e+"/pay/unifiedorder",a=this.orderData.fromdate.substring(0,7),i=this.orderData.room+"房"+a+"期账单",o=100*this.orderData.total,s=this.loginUser.openid,c={openid:s,body:i,out_trade_no:this.orderData.orderid,total_fee:o};n["b"].axios.get(r,{params:c}).then(function(e){var r=e.data;console.log(e.data),"SUCCESS"===r.code?t.wxPay(r.data):l.alert("支付异常："+r.msg)})}},e.prototype.wxPay=function(t){function e(){WeixinJSBridge.invoke("getBrandWCPayRequest",o["a"]({},t),function(t){console.log("wxPayCallback",t),t.err_msg})}console.log("wxPay->",t),"undefined"===typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",e,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",e),document.attachEvent("onWeixinJSBridgeReady",e)):e()},e.prototype.onSwitchRecord=function(){this.isShowRec=!this.isShowRec},Object.defineProperty(e.prototype,"showProps",{get:function(){var t=["orderid","createdtime","rent","deposit","wifi","trash","water","electricity","total"];return this.orderData.finishedtime&&(t.push("transaction_id"),t.push("finishedtime")),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"recordProps",{get:function(){return["lastwatercnt","watercnt","lastelectricitycnt","electricitycnt","fromdate","todate"]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortedOrder",{get:function(){var t=[];for(var e in this.allOrderData)if(this.allOrderData.hasOwnProperty(e)){var r=this.allOrderData[e];t.push(r)}return t.sort(function(t,e){var r=new Date(t.fromdate),a=new Date(e.fromdate);return r>a?1:-1}),t},enumerable:!0,configurable:!0}),e=o["b"]([n["a"]],e),e}(n["b"]),f=u,h=f,p=r("2877"),v=Object(p["a"])(h,a,i,!1,null,null,null);v.options.__file="Order.vue";e["default"]=v.exports}}]);
//# sourceMappingURL=order.cb175903.js.map